# The Last Frontier

Game Development, KPI 2019

Розробники: Цицилюк Анна, Шаверський Іван (ІП-61)

## Зміст
 * [Короткий опис](#короткий-опис)
 * [Основні конкуренти](#основні-конкуренти)
 * [Основні відмінності](#основні-відмінності)
 * [Базові механіки](#базові-механіки)
 * [Очікувані враження](#очікувані-враження)
 * [Цільова аудиторія](#цільова-аудиторія)
 * [Деякі задачі, які нам довелось вирішувати](#деякі-задачі,-які-нам-довелось-вирішувати)
   * [Архітектура](#архітектура)
   * [Спрайти та анімації](#спрайти-та-анімації)
   * [Використання данних турелі](#використання-данних-турелі)
   * [Конфігурування рівня та генерація ворогів](#конфігурування-рівня-та-генерація-ворогів)
   * [Генерація змісту лутбоксів](#генерація-змісту-лутбоксів)
 
## Короткий опис
**The Last Frontier** - це гра у якій ви залишилися на останньому рубежі оборони людства від інопланетних загарбників. 
Ви маєте не дати ворогам пройти цю межу та будь якою ціною її захистити. 
У цьому вам допоможе ваша модульна пушка, яка з потрібними матеріалами може підлаштуватись під будь-яку загрозу.

**Ціль гри** - Відразити напад інопланетян та захоплених ними організмів (Пройти усі рівні).

**Ціль рівня** - Знищити усіх ворогів, не допустивши руйнування ваших баррикад.

## Основні конкуренти
- Defender (1, 2, 3) – "класична" гра такого виду tower defense. Один з перших прикладів такого геймплею на смартфонах. Має лінійну прогресію і сильно сповільнює ваше просування по рівням для більшого прибутку. Починаючи з третої частини додали елементальну зброю.
- Steampunk tower (1,2) – має більшу варіативність ніш попередні ігрі у розвитку та покрещеню турелей. Ігровий процесс зфокусований та менеджменті ресурсів та швидкому прийнятті рішеннь. Друга частина додала менджмент ресурсів поза рівнями (глобально).
- Peacekeeper (наразі недоступна у Play Market) – 
відрізняєтся від перших двох ігор тим, що "турель", якою ми граємо перестає бути статичною і ми можемо нею рухатись для того, щоб уникати атак ворогів. Окрім цього особливих відмінностей немає і має дуже просту та прімітивну систему прогресії.

## Основні відмінності
- Широкий вибір різних "баз" для турелі та видів різноманітних спряджуваних модулів, які перерозподіляють та змінють характеристики, впливають на поведінку вашої зброї та модифікують ігровий процес дозволяючи підлаштовуватись під різнованітні ігрові ситуації.
- Взаємодія з ігровим полем, як зі сторони гравця таке і з сторони ворогів, щоб збільшити складність гри та глубину ігрового процесу, заохотити різноманітність у виборі компонентів турелі. (Наприклад місця обмеженої видимості чи бар'єри)

## Базові механіки
**На рівні:**
- Стрільба по ворогам
- Використання особливих допоміжних пристроїв (abilities). Деякі з них наносять додаткові пошкодження, інші ж дають особливі ефекти та взаємодіють з полем та ворогами (*)

**У меню:**
- Перегляд списку рівнів та їх запуск
- Запуск режиму "Виживання" (Нескінченної гри для заробітку ресурсів) (*)
- Перегляд баз, модулів у сховищі
- Поєднання різноманітних баз та модулів у нову турель
- Розпилення непотрібних деталей для отримання металу (*)
- Створення деталей потрібного виду з металу (*)
- Відкриття лутбоксів з ріноманітними базами та модулями
 
(*) - ще не реалізовано

## Очікувані враження
- Радість та полегшення викликане проходженням складної перешкоди (Босса або навіть просто складного рівня)
- Розслаблення викликане проходженння простих рівнів
- Цікавість до того, які модулі та бази ще можна віднайти
- Задоволення від зроблених власноруч та дещо унікальних турелей

## Цільова аудиторія
Наша цільова аудиторія це ті гравці, яким спобалися ігри на кшталт Defender, Peacekeeper, Steampunk tower та інших, і хотіли б більши глибини у кастомізації турелі та розвитку, а також більшого різноманіття у ігрових ситуаціях.

## Деякі задачі, які нам довелось вирішувати

### Архітектура
Для написсання гри ми вирішили виділити її на два проекти: в одному (TLFGameLogic) зберігаються та оброблюються усі дані. 
а також виконується "бізнес логіка" (Генерація лутбоксів і тд). У іншому (The Last Frontier) залишаються тільки речі, які залежать від нашого engine (а саме Unity). 
Тобто, здебільшго це відображення, але також використовуются речі типу регістрації попадань та фізичного ядра Unity.
Отже ми не можемо назвати це MVC, бо і TLFGameLogic і The Last Frontier не діляться чітко на рівні. Це уже трохи більше походить на компонентний підхід.

**Переваги:**
- Більша розмежованість коду аніж у чисто компонентній моделі.
- Можливість протестувати частину базової ігрової логіки окремо від відображення
- Використання можливостей Unity замість витрачання часу на написання свохї варіантів
- Трохи швидша розробка для такого малого обьему роботи

**Недоліки:**
- Не всю ігрову логіку можна легко протестувати
- При розвитку та розширенню проекту можуть з'явитись трудонощі через відсутність чіткого розмежування функциональних рівнів, які як наслідок будуть тільки погіршувати ситуацію

### Спрайти та анімації
Для будь-якої гри потрібна графіка і для таких малих проектів є два варіанти: малювати усе самим або узяти частину з магазинів або відкритих джерел. 
Було прийнято рішення спробувати самим намалювати усю графіку для гри. залучившись підтримкою знайомого художника для редагування наших малюнків та анімацій.

*pictures placeholder*

**Переваги:**
- Контроль над виглядом гри. Ми самі вирішуємо, як вона буде виглядати та малюємо усе по мірі можливостей.
- За хорошої реалізації гра завжди буде виглядати цілісною. (Елементи не будуть виділятися чи протирічити стилю гри)
- Не потрібно витрачати гроші на спрайти та анімації з магазину

**Недоліки:**
- На це витрачається набагато більше часу
- При недостатності навичок це витрачає ще більше часу, при меншому (ніж очікувалось) результаті
- Не на всі ідеї може вистачити часу та можливостей

### Використання данних турелі
Наша турель може складатися з багатьох різних модулів та мати різні бази. Усе це впливає на характеристики нашої зброї такі, 
як тип набоїв, швидкість пострілів, швидкість набоїв, кілікості одночасно вистрілюваних набоїв, пошкодження від кожного попадання, 
сила відштовхування та багато іншого. Так, як гра передбачає нескінченну кількість комбінацій, то ми глобально зробили дві речі: 
- Замість використання і прораховування всіх цих параметрів "на ходу" під час ігрового процесу,
ми прораховуємо усі необхідні параметри (агрегуємо) під час загрузки рівня (LevelLoader) і використовуємо уже прораховані дані (CurrentCannonLoadoutProvider).
- Так як у всі бази та деякиі деталеі можуть мати різний вигляд (впливати на загальний вигляд турелі), то нам потрібно було забезпечити 
систему для зручного додавання нових виглядів елементів та їх підгрузки під час загрузки рівня (LevelLoader). 
Вона реалізована у вигляді Enum'ів на рівні не пов'язаному з Unity, а на іншому ми за допомогою різних SpriteResolver або PrefabResolver 
(в залежносты выд потрібного функціоналу) вирішуємо, яка модель нам потрібна.

**Переваги:**
- Не потрібно обраховувати кожен раз параметри турелі (пришвидшення)
- Більше зручності у роботі з агрегованими данними (Але і чисті наданні не втрачені, вони теж поставляються з агрегованими у виді об'єкту Cannon)
- Можливість досить швико додати нове відображення для елементу турелі

**Недоліки:**
- Поки що CurrentCannonLoadoutProvider написаний не дуже добре, виконує забагато функцій і погано розбитий. 
Можливо треба, ще подумати над тим, щоб перенести опрацьовування необхідних параметрів у окремі класи, та й узагалі розбити цей клас по функціональності.
- Мешна гнучкість при розробці нових видів деталей та турелей
- Якщо не працював над грою спочатку і так як немає документації, то спосіб підгрузки деталей турелі може бути не дуже очевидним. 

### Конфігурування рівня та генерація ворогів
Наша гра зав'язана на рівнях і кожен з цих рівнів потрібно, якось конфігурувати: додавати ворогів, вказади де вони з'являтся і 
коли та деяку іншу корисну інформацію. У нас уся ця інформація зберігаєтся у класі LevelInfo. 
Вороги, які будуть з'являтися описані елементами списку типу EnemySpawnInfo, яка включаэ у себе enum EnemyType, час появи та enum 
SpawnPoint (Вирішили прив'язатися до окремих точок, як до місць появи ворога і їх у нас 7 штук). При загрузці загрузці рівня (LevelInfo) ми 
ми пов'язуэмо enum SpawnPoint з реальними точками на сцені. Потім у SpawnManager збираэмо за допомогою LevelInfoProvider нашу інформацію про рівень
сортуємо ворогів по часу появи і починаємо відлік, перевіряючи чи не прийшов час когось створити. Створются префаби ворогів за допомогою
IEnemyFactory, який наразі реалізований на створення і видалення ворогів у реальному часі, але можна легко зробити pooled реалізацію.

**Переваги:**
- Додавання нових рівнів не потребує багато часу (у написанні)
- Не потрібно перейматися за точність вказування порядку ворогів.
- Додавання нових типів ворогів не потребує великих зусиль.
- Досить легко розширити або замінити функціональність елементів системи

**Недоліки:**
- Додавання нових рівнів потребує більшого часу на тестування, бо текстовий варіант не передає відчуття від рівня.
- Не реалізована система для швидкого тестування нових рівнів

### Генерація змісту лутбоксів
Наша гра передбачає багато різноманітних деталей, що здебільшого добуваються за рахунок лутбоксів. Нам потрібно було написати логіку 
генерування деталей хоча б одного лутбокса. Для цього нам також потрібно було реалізувати генерування деталей різної якості (Rang) з 
нечітко прописаними характеристиками. Наразі для швидкості ми усе це реалізували у класі CannonPartFactory. Наразі він виконує усі 
ці функції, що не є хорошою практикою, але це дозволило нам швидко реалізувати потрібний функціонал. 
Для початку, при генерації нової деталі ми вирішуємо, який тип цієї деталі (База, дуло тощо) з рівним шансом на усе. Також ми вірішуємо 
яка буде рідкість деталі (Rang може бути Common, Uncommon, Rare, Epic та Legendary). Далі для обраного типу деталі та її рідкості 
за мінімумами та максимумами значень параметрів з констант CannonConfig за допомогою білдерів (у кожного типудеталі свій білдер) 
генеруємо нову деталь. Значення вибирається за нормальним розподілом, завдяки чому більшість предметів мають середню цінність.

**Переваги:**
- Дуже погані та дуже хороші деталі це скоріше рідкість, що збільшує емоції від їх отримання
- Легко сконфігурувати потрібні значення для деталей

**Недоліки:**
- Цю реалізацію потрібно якісно розбити, бо дуже скоро при доданні нових типів лутбоксів цей клас буде розростатись, а його використання затруднятись


### Зрозумілий інтерфейс для користувача
Був розроблений зрозумілий для користувачів дизайн головного меню та меню паузи у грі. 
Передпоказ спорядження та його характеристик дозволяє користувачу швидко зрозуміти переваги та недоліки кожноі частини турелі. 
Меню рівнів дозволяє швидко орієниуватись по пройденим (жовтим) та доступним (зеленим) рівням.
Всі кнопки розташовані в звичних для користувачів місцях і перетаскування речей для їх спорядження є наглядним та приємним доповненням.

**Переваги:**
- Інтуітивне зрозуміле та загалом приємно розташування елементів
- Додання анімацій та ефекту переміщення

**Недоліки:**
- Недопрацьовані відображення споряджених елементів, ранги та сортування предметів по категоріям

